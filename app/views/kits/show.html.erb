<div class="container mt-3 mt-sm-5">
  <div class="d-flex">
    <div class="mt-3 kit-information w-100">
      <h1><%= @kit.name %></h1>
      <p><%= @kit.description %></p>
      <div class="d-none d-sm-flex kit-show-store-main-information-sm">
        <div style="background-image: url(<%= @store.restaurant.brand.logo %>);" class="kit-store-square-logo"></div>
        <div class="store-address">
          <h1><%= @store.restaurant.name %></h1>
          <h4><%= "#{@store.name} - " if @store.name != "" %><%= truncate(@store.address.address, length: 20) %></h4>
        </div>
      </div>
      <div style="background-image: url(<%= @kit.image %>);" class="d-block d-sm-none kit-show-image">
        <% @store.flags.split(", ").each_with_index do |flag, index| %>
        <span class="<%= 'second-category' if index.odd? %>"><%= flag %></span>
        <% end %>
      </div>
      <div class="d-flex kit-store d-block d-sm-none">
        <div id="left" class="ojito"></div>
        <div id="right" class="ojito"></div>
        <div id="right" class="ojito"></div>
        <div style="background-image: url(<%= @kit.restaurant.brand.logo %>);" class="kit-store-logo"></div>
        <div>
          <div class="kit-store-address">
            <h2><%= @kit.restaurant.name %></h2>
            <h4><%= "#{@store.name} - " if @store.name != "" %><%= truncate(@store.address.address, length: 20) %></h4>
          </div>
        </div>
        <div class="d-none d-sm-block map-zone">⚠ Ver zona de envío</div>
      </div>
      <div class="d-block d-sm-none mt-3 map-zone">⚠ Ver zona de envío</div>
      <div class="d-block d-sm-none mt-1 map-zone"  id="ingredients-trigger">Ver ingredientes y utencillos</div>

      <div class="kit-information-disclaimer d-none" id="ingredients" >
        <div>
          <h5>Ingredientes</h5>
          <ul class="mb-0">
            <% @ingredients.each do |ingredient| %>
            <li class="m-0 element"><%= ingredient.name %></li>
            <% end %>
          </ul>
        </div>
        <div>
          <h5>Utencillos requeridos</h5>
          <ul class="mb-0">
            <% if @cookwares.empty? %>
            <li>No especificados.</li>
            <% end %>
            <% @cookwares.each do |cookware| %>
            <li class="m-0 element"><%= cookware.name %></li>
            <% end %>
          </ul>
        </div>
      </div>

      <div class="kit-information-disclaimer kit-details d-sm-none">
        <div class="d-flex justify-content-around">
          <div class="kit-disclaimer">
            <i class="fas fa-utensils"></i>
            <span><%= @kit.size %> personas</span>
          </div>
          <div class="kit-disclaimer">
            <i class="fas fa-utensils"></i>
            <span><%= @kit.preparation_time %> minutos</span>
          </div>
        </div>
        <div class="kit-disclaimer">
          <i class="fas fa-utensils"></i>
          <span><%= @store.days_in_text %></span>
        </div>
        <div class="kit-disclaimer">
          <i class="fas fa-utensils"></i>
          <span>Hace tu pedido <%= @store.next_available_time %></span>
        </div>
      </div>

      <div class="disclaimer kit-information-disclaimer-sm kit-details d-none d-sm-flex">
        <div class="kit-disclaimer kit-disclaimer-sm">
          <i class="fas fa-utensils"></i>
          <span><%= @kit.size %> personas</span>
        </div>
        <div class="kit-disclaimer kit-disclaimer-sm">
          <i class="fas fa-utensils"></i>
          <span><%= @kit.preparation_time %> minutos</span>
        </div>
        <div class="kit-disclaimer kit-disclaimer-sm">
          <i class="fas fa-utensils"></i>
          <span><%= @store.days_in_text %></span>
        </div>
        <div class="kit-disclaimer kit-disclaimer-sm">
          <i class="fas fa-utensils"></i>
          <span>Hace tu pedido <%= @store.next_available_time %></span>
        </div>
      </div>
    </div>
    <div style="background-image: url(<%= @kit.image %>);" class="d-none d-sm-block kit-show-sm-image">
    <% @store.flags.split(", ").each_with_index do |flag, index| %>
      <span class="<%= 'second-category' if index.odd? %>"><%= flag %></span>
    <% end %>
    </div>
  </div>

  <div class="d-flex">
    <div class="w-100 w-sm-50 p-0 p-sm-3">
      <h2 class="mb-2 mt-4 section-secondary store-show-kit-offer">Pedí tu Chef Box</h2>
      <div>
        <%= simple_form_for([@kit, @order])  do |f| %>
        <% stock = [@kit.stock, 10].min %>
        <div class="d-flex justify-content-between">
          <div class="kit-input-group kit-show-xs-input">
            <span id="disabled_dates" data-delivery=<%= @store.disabled.to_json %>></span>
            <label for="amount">Día de Entrega</label>
            <%= f.input :date_delivery, as: :string, required: false, input_html: {class: "datepicker"}, label:false %>
          </div>
          <div class="kit-input-group kit-show-xs-input">
            <label for="amount">Cantidad</label>
            <%= f.input :amount, collection: 1..stock, selected: 1, label: false, placeholder: "Cantidad" %>
            <span data-price="<%= @kit.price %>" id="price"></span>
          </div>
        </div>

        <% if @kit.restaurant.own_delivery %>
        <div class="d-flex align-items-center delivery-options mb-3">
          <div style="background-image: url(<%= @kit.restaurant.brand.logo %>);" class="kit-store-logo mr-3" style="width: 50px; height: 50px;"></div>
          <%= f.input :delivery_provider, collection: Order::PROVIDER, prompt: "Metodo de envío", label: false, required: true, as: :radio_buttons, id: "order_delivery_provider"%>
          <%= f.input :store_id, input_html: { value: @store.id }, as: :hidden %>
        </div>
        <%= f.simple_fields_for :addresses do |a| %>
        <% address = user_signed_in? && !current_user.addresses.last.nil? ? current_user.addresses.last.address : nil %>
        <% flat_number = user_signed_in? && !current_user.addresses.last.nil? ? current_user.addresses.last.flat_number : nil %>
        <div class="justify-content-between hide-field-address" id="address_fields">
          <div class="kit-input-group kit-show-sm-input">
            <label for="amount">Dirección de Entrega</label>
            <%= a.input :address, placeholder: "Ingresar dirección...", label: false, input_html: { value: address }  %>
          </div>
          <div class="kit-input-group kit-show-sm-input">
            <label for="amount">Piso o lote</label>
            <%= a.input :flat_number, placeholder: "Piso o lote", label: false, input_html: { value: flat_number } %>
          </div>
        </div>
        <%= a.input :state, placeholder: "Provincia", label: false, as: :hidden %>
        <%= a.input :city, placeholder: "Localidad", label: false, as: :hidden %>
        <%= a.input :cp, placeholder: "Código Postal", label: false, as: :hidden %>
        <% end %>
        <% else %>
        <div class="d-flex">
          <%= f.input :delivery_provider, collection: Order::PROVIDER2, label: "Metodo de envío", required: true, as: :radio_buttons%>
          <% end %>
          <div>
            <p id="store_address" class="hide-store-address">Lo notificaremos por teléfono o email para su retiro del pedido en nuestro restaurant (<%= @store.address.address %>)</p>
            <%= f.input :comment, placeholder: "Comentario", label: false %>
            <%= f.submit "Seleccione la cantidad de Kits", class:"btn btn-primary btn-block disabled", id:"submit_order_kit", disabled:"disabled" %>
            <% end %>
          </div>
        </div>
      </div>
      <div class="d-none d-sm-block w-100 mt-0 mt-3 pl-3">
        <div>
          <h5 class="mt-4">Ingredientes</h5>
          <ul class="mb-0">
            <% @ingredients.each do |ingredient| %>
            <li class="m-0 element"><%= ingredient.name %></li>
            <% end %>
          </ul>
        </div>
        <div>
          <h5 class="mt-3">Utencillos requeridos</h5>
          <ul class="mb-0">
            <% if @cookwares.empty? %>
            <li>No especificados.</li>
            <% end %>
            <% @cookwares.each do |cookware| %>
            <li class="m-0 element"><%= cookware.name %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>

    <h2 class="mb-4 section-secondary store-show-kit-offer">Otros Chef Boxes</h2>
    <div class="kits-wrapper">
      <% @kits.each do |kit| %>
      <%= render "components/kit", kit: kit, kits: @kits %>
      <% end %>
    </div>

    <h2 class="mb-4 section-secondary store-show-kit-offer">Otros restaurants similares</h2>

  </div>
